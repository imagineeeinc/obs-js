const still="still",update="update",mesh="mesh",customMesh="customMesh",canvasShape=mesh,sprite="sprite",lineRndr="lineRenderer",line=lineRndr,text="text",texture="texture",rect="rect",circle="circle",paths="paths",plainText="plainText",hitbox="hitbox";var imgStore={};const defaultFont="30px Arial",error={noSupport:"Your browser dose not support canvas"};var lastUpdate=Date.now(),deltaTime=0;class CaveRenderEngine{constructor(t){this.bgColor=t.bgColor,this.canvasId=t.canvasId,this._drawers=this._theDrawers(),this.campos=[0,0]}setUpImageCacher(){let t=document.createElement("div");return t.style.display="none",t.id="caveImageCache"+Math.round(Math.floor(9999*Math.random())+1e3),document.body.append(t),t.id}zeroToCenter(t){let e=document.getElementById(this.canvasId);if(!e.getContext)return[!1,error.noSupport];var s=e.getContext("2d");if(!0===t)s.translate(e.width/2,e.height/2);else{if(!1!==t)return[!1,"no given boolen"];s.translate(0,0)}}draw(t,e,s,i){let r=Date.now();this.fps=e,this.scene=t.vScene;let n=document.getElementById(this.canvasId);if(!n.getContext)return[!1,error.noSupport];var h=n.getContext("2d",{alpha:!1});h.font=defaultFont,h.imageSmoothingEnabled=s,h.fillStyle=this.bgColor,h.clearRect(-50,-50,n.width+100,n.height+100),h.fillRect(-50,-50,n.width+100,n.height+100);let a=[i.x,i.y];a[0]==this.campos[0]&&a[1]==this.campos[1]||(h.translate(a[0]-this.campos[0],a[1]-this.campos[1]),this.campos=a);for(var o=0;o<this.scene.length;o++){let t=this.scene[o];if(null!=t.scripts){let e,s=t.scripts;for(var c=0;c<s.length;c++){let i=s[c].importScript||function(){return null},r=s[c].script;i=i(),e=r(t,i,{fps:this.fps,delta:deltaTime,screen:n,camera:this.campos}),t=e||t}}if(t.type==mesh){if(t.drawType==rect){this._drawers.rect(h,[t.x-t.width/2,t.y-t.height/2,t.width*t.scale,t.height*t.scale,t.color])}else if(t.drawType==circle){this._drawers.circle(h,[t.x-t.width/2,t.y-t.height/2,t.width*t.scale,t.color])}}else if(t.type==sprite){if(t.drawType==texture){this._drawers.texture(h,[t.x-t.width/2,t.y-t.height/2,t.width*t.scale,t.height*t.scale,t.texture])}}else if(t.type==text){if(t.drawType==plainText){this._drawers.plainText(h,[t.x-t.width/2,t.y-t.height/2,t.txt,t.font,t.color])}}else if(t.type==line){this._drawers.lineRndr(h,[t.start,t.end,t.width,t.color])}else if(t.type==customMesh){this._drawers.customMesh(h,t.meshShader)}}let l=r-lastUpdate;return lastUpdate=r,deltaTime=l/100,[!0]}_theDrawers(){return{rect:function(t,e){return t.fillStyle=e[4],t.fillRect(e[0],e[1],e[2],e[3]),!0},circle:function(t,e){return t.beginPath(),t.arc(e[0],e[1],e[2],0,2*Math.PI),t.fillStyle=e[3],t.fill(),t.closePath(),!0},texture:function(t,e){return t.drawImage(e[4],e[0],e[1],e[2],e[3]),!0},plainText:function(t,e){return t.font=e[3],t.fillText(e[2],e[1],e[0]),!0},lineRndr:function(t,e){return t.strokeStyle=e[3],t.lineWidth=e[2],t.beginPath(),(e[0].isVectObj=!0)?t.moveTo(e[0].x,e[0].y):t.moveTo(e[0][0],e[0][1]),(e[1].isVectObj=!0)?t.lineTo(e[1].x,e[1].y):t.lineTo(e[1][0],e[1][1]),t.stroke(),!0},customMesh:function(t,e){return(0,e.script)(t),!0}}}}class newOrbsScene{constructor(){this.vScene=[]}add(t){this.vScene.push(t)}scene(){return this.vScene}moveObj(t,e){this.vScene=array_move(this.vScene,t,e)}getObj(t){for(var e=0;e<this.vScene.length;e++)if(this.vScene[e].name==t)return this.vScene[e]}}class newOrbsRenderer{constructor(t){t.canvas?this.canvas=t.canvas:this.canvas=function(){let t=document.createElement("canvas");return t.id="orbsCanvas"+Math.round(Math.floor(9999*Math.random())+1e3),t.innerHTML="Hmm, Looks like your browser does not support Canvas",t}(),this.antiAliasing=t.antiAliasing||!0,this.canvasId=this.canvas.id,this.bgColor=t.bgColor||"#ffffff",this.fps=t.fps||30,this.renderState=t.renderState||still,this.dynamicCamera=t.dynamicCamera||!1,this.cameraPos=t.camPos||{x:0,y:0},this.renderState==still?this.updater=!1:this.renderState==update?this.updater=!0:console.error("no proper given renderState.\noptions:( update | still )"),this.scene=t.scene||new newOrbsScene,this.cave=new CaveRenderEngine({bgColor:this.bgColor,canvasId:this.canvasId}),1==t.disableImageCache||(this.storeId=this.cave.setUpImageCacher())}startRenderCycle(){let t=this.cave;setInterval((()=>function(t,e,s,i,r,n){if(!0===s){let s=t.draw(e,i,r,n);!1===s[0]&&(alert(s[1]),console.alert(s[1]))}}(t,this.scene,this.updater,this.fps,this.antiAliasing,this.cameraPos)),1e3/this.fps)}zeroToCenter(t){this.cave.zeroToCenter(t)}attachCanvas(t){this.canvas=t,this.canvasId=this.canvas.id}addToImgCache(t,e){document.getElementById(this.storeId);let s=new Image;s.src=t,imgStore[e]=s}setRenderState(t){this.renderState=t||still,this.renderState==still?this.updater=!1:this.renderState==update?this.updater=!0:console.error("no proper given renderState.\noptions:( update | still )")}setSize(t,e){this.canvas.width=t,this.canvas.height=e}setBgColor(t){this.bgColor=t}setScene(t){this.scene=t}draw(t){this.tempScene=t}translateCamera(t){this.cameraPos=t}}class newOrbsObj{constructor(t){this.name=t.name||Math.round(Math.floor(9999*Math.random())+1e3),this.type=t.type||mesh,this.type==mesh&&(this.drawType=t.drawType),this.drawType=t.drawType||texture,this.type!=line&&this.type!=customMesh||(this.drawType=null),this.scripts=[],this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.color=t.color||"#000",this.scale=t.scale||1,this.rotation=t.rotation||0,this.texture=null}_giveCodec(){return{type:this.type,drawType:this.drawType,x:this.x,y:this.y,width:this.width,height:this.height,color:this.color}}attachScript(t){this.scripts.push(t)}setVars(t,e){this[t]=e}drawFunc(...t){this.type==mesh?this.drawType==rect?(this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3],this.color=t[4],this.scale=t[5]||1):this.drawType==circle&&(this.x=t[0],this.y=t[1],this.width=t[2],this.color=t[3],this.scale=t[4]||1):this.type==sprite?this.drawType==texture&&(this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3],this.texture=t[4],this.scale=t[5]||1):this.type==text?this.drawType==plainText&&(this.x=t[0],this.y=t[1],this.txt=t[2],this.font=t[3],this.color=t[4]||"black",this.scale=t[5]||1):this.type==line?(this.start=t[0],this.end=t[1],this.width=t[2],this.color=t[3]||"black"):this.type==customMesh&&(this.meshShader=t[0])}move(t){let e=t._giveVector();this.x=this.x+e[0]||this.x,this.y=this.y+e[1]||this.y,this.scale=this.scale+e[2]||this.scale,this.rotation=this.rotation+e[3]||this.rotation}setPos(t){let e=t._giveVector();this.x=e[0]||this.x,this.y=e[1]||this.y,this.scale=e[2]||this.scale,this.rotation=e[3]||this.rotation}}class newOrbsScriptComponent{constructor(t){this.script=t||function(){return null}}attachScript(t){this.script=t}imports(t){this.importScript=t}}class Vector{constructor(t,e,s,i){this.isVectObj=!0,this.x=t||null,this.y=e||null,this.scale=s||null,this.rot=i||null}_giveVector(){return[this.x,this.y,this.scale,this.rot]}}function Vect(t,e,s,i){return new Vector(t,e,s,i)}class primitiveGravity{constructor(t){console.log("gravity is not yet implemented")}}const ORBS={setFullScreenGameCss:function(){document.body.setAttribute("style","padding: 0;\n    margin: 0;\n    height: 100vh")},_:function(){return[new newOrbsRenderer,new newOrbsScene]},renderer:newOrbsRenderer,scene:newOrbsScene,obj:newOrbsObj,scriptComponent:newOrbsScriptComponent,Vector:Vector,components:{primitiveGravity:primitiveGravity}};function echo(t,e){return console.log(t+`[ln: ${e}]`)}function array_move(t,e,s){if(s>=t.length)for(var i=s-t.length+1;i--;)t.push(void 0);return t.splice(s,0,t.splice(e,1)[0]),t}
